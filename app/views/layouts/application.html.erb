<!DOCTYPE html>
<html>
  <head>
    <title>Musthave</title>
    <%= csrf_meta_tags %>
    <%= action_cable_meta_tag %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %> <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>

    <style type="text/css">
    </style>
  </head>

  <body>

    <nav>
      <div class="nav-wrapper">
        <a href="/" class="brand-logo">MustHave</a>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
          <li><a href="/">Home</a></li>
               <% if user_signed_in? %>
                 <li><%= link_to 'Garrages', garrages_path %></li>
                 <li><%= link_to 'Stuffs', stuffs_path %></li>
                 <li><%= link_to 'Sign Out', destroy_user_session_path, :method => 'delete' %></li>
               <% else %>
                 <li><%= link_to 'Log In', new_user_session_path %></li>
                 <li><%= link_to 'Sign Up', destroy_user_session_path, :method => 'delete' %></li>
               <% end %>
        </ul>
      </div>
    </nav>

    <%= yield %>

    <script type="text/javascript">
      var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      var labelIndex = 0;

      function initMap() {
        var myLatLng = {lat: 37.5639, lng: 126.9031};
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 17,
          center: myLatLng
        });

        var contentString = 'hi';

        var infowindow = new google.maps.InfoWindow({
          content: contentString,
          maxWidth: 200
        });

       /* google.maps.event.addListener(map, 'click', function(event) {
          location.href="/garrages/new?lat=" + event.latLng.lat() + "&lng=" + event.latLng.lng();
        }); */

        <% Garrage.all.each do |g| %>
            addMarker(new google.maps.LatLng(<%= g.latitude %>,<%= g.longitude %>), map);
        <% end %>
      }

      function addMarker(location, map) {
        var marker = new google.maps.Marker({
          position: location,
          label: labels[labelIndex++ % labels.length],
          map: map
        });
      }

    </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBetvh03PhdJcNsggLq66l8HeO04SJCpDs&callback=initMap">
    </script>
  </body>
</html>
